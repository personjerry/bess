n = int($N!'2')
k = int($K!'2')
assert(n >= k)

f = FCR(size=0, bucket=0)
p = Port(driver='PMD', port_id=0)
pr = []

for i in range(n):
    id = i + 1
    pr.append(Probe(id=id))

PortInc(port=p) -> f -> pr[0]

for i in range(n - 1):
    pr[i] -> pr[i+1]

pr[n - 1] -> PortOut(port=p)

for i in range(k):
    pr[i].query(enabled=1)
